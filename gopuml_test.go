package gopuml_test

import (
	"testing"

	"github.com/stretchr/testify/assert"

	"github.com/lonnblad/gopuml"
)

func Test_Deflate(t *testing.T) {
	input := []byte("@startuml Example\nBob -> Alice : hello\n@enduml")
	expectedOutput := []byte{0x72, 0x28, 0x2e, 0x49, 0x2c, 0x2a, 0x29, 0xcd, 0xcd, 0x51, 0x70, 0xad, 0x48, 0xcc, 0x2d, 0xc8, 0x49, 0xe5, 0x72, 0xca, 0x4f, 0x52, 0xd0, 0xb5, 0x53, 0x70, 0xcc, 0xc9, 0x4c, 0x4e, 0x55, 0xb0, 0x52, 0xc8, 0x48, 0xcd, 0xc9, 0xc9, 0xe7, 0x72, 0x48, 0xcd, 0x4b, 0x29, 0xcd, 0xcd, 0x1, 0x4, 0x0, 0x0, 0xff, 0xff} // nolint: lll

	actualOutput, actualErr := gopuml.Deflate(input)
	assert.Nil(t, actualErr)
	assert.Equal(t, expectedOutput, actualOutput)
}

func Test_Encode(t *testing.T) {
	input := []byte{0x72, 0x28, 0x2e, 0x49, 0x2c, 0x2a, 0x29, 0xcd, 0xcd, 0x51, 0x70, 0xad, 0x48, 0xcc, 0x2d, 0xc8, 0x49, 0xe5, 0x72, 0xca, 0x4f, 0x52, 0xd0, 0xb5, 0x53, 0x70, 0xcc, 0xc9, 0x4c, 0x4e, 0x55, 0xb0, 0x52, 0xc8, 0x48, 0xcd, 0xc9, 0xc9, 0xe7, 0x72, 0x48, 0xcd, 0x4b, 0x29, 0xcd, 0xcd, 0x1, 0x4, 0x0, 0x0, 0xff, 0xff} // nolint: lll
	expectedOutput := []byte("SYWkIImgAStDKN2jICmjo4dbSifFKj2rKt3CoKnELR1Io4ZDoSddSaZDIodDpG44003__m00")

	actualOutput := gopuml.Encode(input)
	assert.Equal(t, expectedOutput, actualOutput)
}
